import { describe, expect, it } from "bun:test";
import { hash, hashInto } from "../../src/index.js";

describe("hash", () => {
	it("hash", () => {
		const data = new Uint8Array(64).fill(0xab);
		const out = hash(data);
		expect(out.length).toBe(32);
		expect(out).toEqual(
			new Uint8Array([
				0xec, 0x65, 0xc8, 0x79, 0x8e, 0xcf, 0x95, 0x90, 0x24, 0x13, 0xc4, 0x0f,
				0x7b, 0x9e, 0x6d, 0x4b, 0x00, 0x68, 0x88, 0x5f, 0x5f, 0x32, 0x4a, 0xba,
				0x1f, 0x9b, 0xa1, 0xc8, 0xe1, 0x4a, 0xea, 0x61,
			]),
		);
	});

	it("hashInto", () => {
		const data = new Uint8Array(64).fill(0xab);
		const out = new Uint8Array(32);
		hashInto(data, out);
		expect(out).toEqual(
			new Uint8Array([
				0xec, 0x65, 0xc8, 0x79, 0x8e, 0xcf, 0x95, 0x90, 0x24, 0x13, 0xc4, 0x0f,
				0x7b, 0x9e, 0x6d, 0x4b, 0x00, 0x68, 0x88, 0x5f, 0x5f, 0x32, 0x4a, 0xba,
				0x1f, 0x9b, 0xa1, 0xc8, 0xe1, 0x4a, 0xea, 0x61,
			]),
		);
	});
});
